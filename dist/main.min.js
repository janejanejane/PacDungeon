!function(){"use strict";function t(t,e,i,s){this.pacman=t,this.ghost=e,this.safetile=i,this.opposites=s}function e(t,e){var i=this.pacman.getGridPosition(),s=0,a=1e3,h=Phaser.NONE;for(s=5;s>0;s--)if(t[s]&&s!==this.opposites[e]&&(t[s].index===this.safetile||t[s].index===r.DungeonGenerator.TOPWALL||t[s].index===r.DungeonGenerator.RIGHTWALL||t[s].index===r.DungeonGenerator.BOTTOMWALL||t[s].index===r.DungeonGenerator.LEFTWALL)&&!this.isAtEdge(t[s].index)){var n=Phaser.Math.distance(i.x,i.y,t[s].x,t[s].y);a>n&&(h=s,a=n)}return h}function i(t,e){var i=this.pacman.getForwardPosition(4),s=0,a=1e3,h=Phaser.NONE;for(s=1;5>s;s++)if(t[s]&&s!==this.opposites[e]&&(t[s].index===this.safetile||t[s].index===r.DungeonGenerator.TOPWALL||t[s].index===r.DungeonGenerator.RIGHTWALL||t[s].index===r.DungeonGenerator.BOTTOMWALL||t[s].index===r.DungeonGenerator.LEFTWALL)&&!this.isAtEdge(t[s].index)){var n=Phaser.Math.distance(i.x,i.y,t[s].x,t[s].y);a>n&&(h=s,a=n)}return h}function s(t,e){for(var i=1;5>i&&(!t[i]||i===this.opposites[e]||t[i].index!==this.safetile);i++);return i}function a(t,e){for(var i=1;5>i&&(!t[i]||i===this.opposites[e]||t[i].index!==this.safetile);i++);return i}var r=window.pacdungeon;t.prototype.setStrategy=function(t){switch(t){case"shadow":this.getNextDirection=e;break;case"speedy":this.getNextDirection=i;break;case"bashful":this.getNextDirection=s;break;case"pokey":this.getNextDirection=a}},t.prototype.isAtEdge=function(t){return t===r.DungeonGenerator.TOPWALL?1===this.ghost.forwardMarker.y:t===r.DungeonGenerator.RIGHTWALL?(console.log("Ghost Marker: ",this.ghost.forwardMarker.x,38===this.ghost.forwardMarker.x),28===this.ghost.forwardMarker.x):t===r.DungeonGenerator.BOTTOMWALL?28===this.ghost.forwardMarker.y:t===r.DungeonGenerator.LEFTWALL?1===this.ghost.forwardMarker.x:!1},window.pacdungeon=window.pacdungeon||{},window.pacdungeon.AIStrategy=t}(),function(){"use strict";function t(t,e,i,s,a){this.level=0,this.x=t,this.y=e,this.data=i,this.main=a,this.timerContainer=s,this.dots=[];var r=a.toWorldPosition(this.x,this.y,0,0);this.countdown=new Phaser.BitmapText(a.game,r.x,r.y,"minecraftia","0"),s.add(this.countdown),this.CELLREFRESHTIME=3e3,this.cellRefresh=-1}t.prototype.isCleared=function(){for(var t in this.dots)if(this.dots[t].alive)return!1;return this.cellRefresh=this.CELLREFRESHTIME,!0},t.prototype.revive=function(){for(var t=0,e=0;e<this.data.length;e++)for(var i=0;i<this.data[e].length;i++)if(7===this.data[e][i]){this.data[e][i]=14;var s=this.dots[t];s||(s=this.main.createDot(),this.dots.push(s));var a=this.main.toWorldPosition(this.x,this.y,e,i);s.revive(),t++,s.x=a.x-3,s.y=a.y-3}},t.prototype.nextLevel=function(){this.level++,this.data=this.main.DungeonGenerator.loadLevel(this.level),this.revive(),this.main.createCellData(this.x,this.y,this.data),this.main.doShakeScreen()},t.prototype.update=function(t){this.cellRefresh<0||(this.cellRefresh-=t.elapsed,this.cellRefresh>0?this.countdown.text=Math.round(this.cellRefresh/1e3):this.cellRefresh<0&&this.nextLevel())},window.pacdungeon=window.pacdungeon||{},window.pacdungeon.Cell=t}(),function(){"use strict";function t(t,e){this.tilemap=e,console.log("tilemap?",e),this.size=t||10,this.TOPLEFTCORNER=1,this.TOPWALL=2,this.TOPRIGHTCORNER=5,this.LEFTWALL=6,this.RIGHTWALL=10,this.BOTTOMLEFTCORNER=20,this.BOTTOMRIGHTCORNER=24,this.BOTTOMWALL=21,this.SAFE=14}t.TOPLEFTCORNER=1,t.TOPWALL=2,t.TOPRIGHTCORNER=5,t.LEFTWALL=6,t.RIGHTWALL=10,t.BOTTOMLEFTCORNER=20,t.BOTTOMRIGHTCORNER=24,t.BOTTOMWALL=21,t.prototype={createSquare:function(){for(var t=[],e=0;e<this.size;e++){t.push([]);for(var i=0;i<this.size;i++)0===e?0===i?t[i][e]=this.TOPLEFTCORNER:t[e][i]=i===this.size-1?this.BOTTOMLEFTCORNER:this.LEFTWALL:t[e][i]=e===this.size-1?0===i?this.TOPRIGHTCORNER:i===this.size-1?this.BOTTOMRIGHTCORNER:this.RIGHTWALL:0===i?this.TOPWALL:i===this.size-1?this.BOTTOMWALL:this.SAFE}return t},loadLevel:function(t){for(var e=t%3,i=Math.floor(t/3),s=[],a=0;a<this.size;a++){s.push([]);for(var r=0;r<this.size;r++){var h=10*e+a,n=10*i+r;s[a][r]=this.tilemap.getTile(h,n,0).index}}return s}},window.pacdungeon=window.pacdungeon||{},window.pacdungeon.DungeonGenerator=t}(),function(){"use strict";function t(t,e,i,s){switch(Phaser.Sprite.call(this,t.game,e,i,"ghost"),this.debug=!1,this.main=t,this.speed=.9*this.main.speed,this.type=s||l[Math.floor(4*Math.random())],this.directions=[null,null,null,null,null],this.type){case"shadow":this.tint=r;break;case"speedy":this.tint=h;break;case"bashful":this.tint=n;break;case"pokey":this.tint=o}this.animations.add("munch",[0,1,2,3],20,!0),this.animations.play("munch"),this.ghostEyes=new Phaser.Sprite(t.game,0,0,"ghost-eyes"),this.ghostEyes.frame=a,this.ghostEyes.anchor.set(.5),this.addChild(this.ghostEyes),this.marker=new Phaser.Point(0,0),this.forwardMarker=new Phaser.Point(0,0),this.current=Phaser.DOWN,this.nextDirection=Phaser.NONE,this.turnPoint=new Phaser.Point,this.futurePoint=new Phaser.Point,this.threshold=3,this.targetFound=!1,this.strategy=new c.AIStrategy(t.pacman,this,t.safetile,t.opposites),this.strategy.setStrategy(this.type),this.changeDirection=!1}var e=2,i=0,s=1,a=3,r=16711680,h=16738740,n=65535,o=16712960,l=["shadow","speedy","bashful","pokey"],c=window.pacdungeon;t.prototype=Object.create(Phaser.Sprite.prototype),t.prototype.constructor=t,t.prototype.move=function(t){var r=this.speed;(t===Phaser.LEFT||t===Phaser.UP)&&(r=-r),t===Phaser.LEFT||t===Phaser.RIGHT?this.body.velocity.x=r:this.body.velocity.y=r,t===Phaser.UP?this.ghostEyes.frame=a:t===Phaser.DOWN?this.ghostEyes.frame=s:t===Phaser.LEFT?this.ghostEyes.frame=e:t===Phaser.RIGHT&&(this.ghostEyes.frame=i),this.current=t},t.prototype.getForward=function(t){return this.current===Phaser.RIGHT?t.x+=1:this.current===Phaser.LEFT?t.x-=1:this.current===Phaser.UP?t.y-=1:this.current===Phaser.DOWN&&(t.y+=1),t},t.prototype.feelForward=function(){this.marker.x=this.main.game.math.snapToFloor(Math.floor(this.x),this.main.gridsize)/this.main.gridsize,this.marker.y=this.main.game.math.snapToFloor(Math.floor(this.y),this.main.gridsize)/this.main.gridsize,this.forwardMarker=this.getForward(new Phaser.Point(this.marker.x,this.marker.y)),this.marker.x<0||this.marker.y<0||(this.futurePoint.x=this.forwardMarker.x*this.gridsize+this.gridsize/2,this.futurePoint.y=this.forwardMarker.y*this.gridsize+this.gridsize/2,this.turnPoint.x=this.forwardMarker.x*this.gridsize+this.gridsize/2,this.turnPoint.y=this.forwardMarker.y*this.gridsize+this.gridsize/2,this.directions[0]=this.main.map.getTile(this.forwardMarker.x,this.forwardMarker.y,this.main.layer.index),this.directions[1]=this.main.map.getTileLeft(this.main.layer.index,this.forwardMarker.x,this.forwardMarker.y),this.directions[2]=this.main.map.getTileRight(this.main.layer.index,this.forwardMarker.x,this.forwardMarker.y),this.directions[3]=this.main.map.getTileAbove(this.main.layer.index,this.forwardMarker.x,this.forwardMarker.y),this.directions[4]=this.main.map.getTileBelow(this.main.layer.index,this.forwardMarker.x,this.forwardMarker.y),this.nextDirection=this.strategy.getNextDirection(this.directions,this.current),this.targetFound=!0)},t.prototype.turn=function(){this.x=this.turnPoint.x,this.y=this.turnPoint.y,this.body.reset(this.turnPoint.x,this.turnPoint.y)},t.prototype.reachedGoal=function(){var t=Math.floor(this.x),e=Math.floor(this.y);return this.main.math.fuzzyEqual(t,this.turnPoint.x,this.threshold)&&this.main.math.fuzzyEqual(e,this.turnPoint.y,this.threshold)?!0:!1},t.prototype.update=function(){this.targetFound||(this.feelForward(),this.move(this.current)),this.reachedGoal()&&(this.targetFound=!1,this.turn(),this.current=this.nextDirection)},t.prototype.render=function(){if(this.debug){for(var t=0;5>t;t++)if(null!==this.directions[t]){var e="rgba(0,255,0,0.3)";this.directions[t].index!==this.main.safetile&&(e="rgba(255,0,0,0.3)"),t===this.current&&(e="rgba(255,255,255,0.3)"),this.game.debug.geom(new Phaser.Rectangle(this.directions[t].worldX,this.directions[t].worldY,this.gridsize,this.gridsize),e,!0)}this.game.debug.geom(new Phaser.Circle(this.turnPoint.x,this.turnPoint.y,5),"rgba(255,0,0,1)"),this.game.debug.geom(new Phaser.Circle(this.x,this.y,5),"rgba(0,0,0,1)"),this.game.debug.geom(new Phaser.Circle(this.marker.x,this.marker.y,5),"rgba(0,255,0,1)")}},window.pacdungeon=window.pacdungeon||{},window.pacdungeon.MonsterAI=t}(),function(){"use strict";function t(t,e,i){Phaser.Sprite.call(this,t.game,e,i,"pacman"),this.debug=!1,this.main=t,this.speed=100,this.threshold=10,this.marker=new Phaser.Point,this.turnPoint=new Phaser.Point,this.current=Phaser.NONE,this.turning=Phaser.NONE,this.directions=[null,null,null,null,null],this.previousTarget=null,this.animations.add("munch",[0,1,2,1],20,!0),this.animations.add("die",[2,3,4],10,!1),this.animations.add("idle",[1],20,!0),this.play("munch")}t.prototype=Object.create(Phaser.Sprite.prototype),t.prototype.constructor=t,t.prototype.onDie=function(){this.angle=0,this.play("die",null,!1,!0)},t.prototype.getGridPosition=function(){return this.main.toGridPosition(this.x,this.y)},t.prototype.getForwardPosition=function(t){var e=this.getGridPosition();return this.current===Phaser.LEFT?e.x-=t:this.current===Phaser.RIGHT?e.x+=t:this.current===Phaser.UP?e.y-=t:this.current===Phaser.DOWN&&(e.y+=t),e},t.prototype.move=function(t){var e=this.speed;(t===Phaser.LEFT||t===Phaser.UP)&&(e=-e),t===Phaser.LEFT||t===Phaser.RIGHT?this.body.velocity.x=e:this.body.velocity.y=e,this.scale.x=1,this.angle=0,t===Phaser.LEFT?this.scale.x=-1:t===Phaser.UP?this.angle=270:t===Phaser.DOWN&&(this.angle=90),this.current=t},t.prototype.turn=function(){var t=Math.floor(this.x),e=Math.floor(this.y);return this.main.math.fuzzyEqual(t,this.turnPoint.x,this.threshold)&&this.main.math.fuzzyEqual(e,this.turnPoint.y,this.threshold)?(this.x=this.turnPoint.x,this.y=this.turnPoint.y,this.body.reset(this.turnPoint.x,this.turnPoint.y),this.move(this.turning),this.turning=Phaser.NONE,!0):!1},t.prototype.checkDirection=function(t){this.turning!==t&&null!==this.directions[t]&&this.directions[t].index===this.main.safetile&&(this.current===this.main.opposites[t]?this.move(t):(this.turning=t,this.turnPoint.x=this.marker.x*this.main.gridsize+this.main.gridsize/2,this.turnPoint.y=this.marker.y*this.main.gridsize+this.main.gridsize/2))},t.prototype.update=function(){},t.prototype.render=function(){if(this.debug)for(var t=1;5>t;t++)if(null!==this.directions[t]){var e="rgba(0,255,0,0.3)";this.directions[t].index!==this.main.safetile&&(e="rgba(255,0,0,0.3)"),t===this.current&&(e="rgba(255,255,255,0.3)"),this.main.game.debug.geom(new Phaser.Rectangle(this.directions[t].worldX,this.directions[t].worldY,this.main.gridsize,this.main.gridsize),e,!0)}},window.pacdungeon=window.pacdungeon||{},window.pacdungeon.Pacman=t}(),function(){"use strict";function t(){}t.prototype={preload:function(){this.load.image("preloader","assets/preloader.gif")},create:function(){this.game.input.maxPointers=1,this.game.device.desktop?this.game.scale.pageAlignHorizontally=!0:(this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.minWidth=480,this.game.scale.minHeight=260,this.game.scale.maxWidth=640,this.game.scale.maxHeight=480,this.game.scale.forceOrientation(!0),this.game.scale.pageAlignHorizontally=!0,this.game.scale.setScreenSize(!0)),this.game.state.start("preloader")}},window.pacdungeon=window.pacdungeon||{},window.pacdungeon.Boot=t}(),function(){"use strict";function t(){e=this,this.livesLeft=3,this.offset=new Phaser.Point(-30,-30),this.map=null,this.layers=[],this.layer=null,this.ghostLayer=null,this.pacman=null,this.monsters=null,this.safetile=14,this.gridsize=16,this.scoreTxt=null,this.livesGroup=null,this.speed=100,this.size=10,this.squareSize=3,this.DungeonGenerator=null,this.cells=[[null,null,null],[null,null,null],[null,null,null]],this.timerContainer=null,this.opposites=[Phaser.NONE,Phaser.RIGHT,Phaser.LEFT,Phaser.DOWN,Phaser.UP],this.score=0,this.teleportZone=new Phaser.Point(0,0),this.activeZone=new Phaser.Point(0,0),this.isFreshJump=!1,this.graphics=null,this.teleportEmitter=null,this.appearEmitter=null,this.shakeWorld=0,this.c1=new Phaser.Point,this.c2=new Phaser.Point}var e,i=window.pacdungeon;t.prototype={create:function(){this.game.world.setBounds(this.offset.x,this.offset.y,this.game.width,this.game.height),this.stage.backgroundColor="#2d2d2d",this.map=this.add.tilemap(),this.map.addTilesetImage("tiles","tiles",16,16,0,0,1),this.layer=this.map.create("main",4*this.size,4*this.size,16,16),this.ghostLayer=this.map.createBlankLayer("ghostLayer",4*this.size,4*this.size,16,16),this.timerContainer=this.add.group();var t=this.game.add.tilemap("levels");this.DungeonGenerator=new i.DungeonGenerator(this.size,t);var s=0,a=0;for(s=0;s<this.squareSize;s++)for(a=0;a<this.squareSize;a++){var r=this.DungeonGenerator.loadLevel(0),h=this.createCellData(s,a,r);this.cells[s][a]=new i.Cell(s,a,h,this.timerContainer,this)}this.createGhostPrison(),this.ghostLayer.visible=!1,this.map.setLayer(this.layer),this.dots=this.add.physicsGroup(),this.map.createFromTiles(7,this.safetile,"dot",this.layer,this.dots),this.dots.setAll("x",6,!1,!1,1),this.dots.setAll("y",6,!1,!1,1);var n=function(t){return function(e){var i=this.toGridPosition(e.x,e.y),s=this.toCellPosition(i.x,i.y);t.x===s.x&&t.y===s.y&&t.dots.push(e)}};for(s=0;s<this.cells.length;s++)for(a=0;a<this.cells[s].length;a++){var o=this.cells[a][s];this.dots.forEach(n(o),this)}this.map.setCollisionByExclusion([this.safetile],!0,this.layer),this.map.setCollisionByExclusion([this.safetile],!0,this.ghostLayer),console.log(this.map),this.graphics=this.add.graphics(0,0),this.monsters=this.add.group(),this.createPacman(16*this.squareSize+8,16*this.squareSize+8),this.livesGroup=this.add.group(),this.updateLives(),this.spawnMonsters(["shadow","speedy"]),this.physics.arcade.enable(this.pacman),this.pacman.body.setSize(16,16,0,0),this.moveToSquare(0,0),this.cursors=this.input.keyboard.createCursorKeys(),this.input.keyboard.onUpCallback=function(t){t.keyCode===Phaser.Keyboard.SPACEBAR?e.teleport():t.keyCode===Phaser.Keyboard.UP?e.updateTeleportZone(Phaser.UP):t.keyCode===Phaser.Keyboard.DOWN?e.updateTeleportZone(Phaser.DOWN):t.keyCode===Phaser.Keyboard.LEFT?e.updateTeleportZone(Phaser.LEFT):t.keyCode===Phaser.Keyboard.RIGHT&&e.updateTeleportZone(Phaser.RIGHT)},this.pacman.move(Phaser.LEFT),this.teleportEmitter=this.add.emitter(),this.appearEmitter=this.add.emitter();var l=function(t){t.makeParticles("pacman",[0,1,2]),t.maxParticleScale=.1,t.minParticleScale=.01,t.width=20,t.setYSpeed(-20,-100),t.setXSpeed(-5,5),t.gravity=-200};l(this.teleportEmitter),l(this.appearEmitter),this.appearEmitter.setYSpeed(100,-20),this.appearEmitter.gravity=200,this.scoreTxt=this.add.bitmapText(0,0,"minecraftia","0"),this.scoreTxt.align="left",this.scoreTxt.x=0,this.scoreTxt.y=-40},updateLives:function(){this.livesGroup.removeAll();for(var t=0;t<this.livesLeft;t++){var e=new i.Pacman(this,30*t,480);e.play("idle"),this.livesGroup.add(e)}},createDot:function(){var t=this.add.sprite(0,0,"dot",this.dots);return this.dots.add(t),t},createCellData:function(t,e,i){for(var s=0;s<this.size;s++)for(var a=0;a<this.size;a++)this.map.putTile(i[a][s],t*this.size+a,e*this.size+s,this.layer);return i},createGhostPrison:function(){for(var t=3*this.size,e=3*this.size,i=0;t>i;i++)this.map.putTile(this.DungeonGenerator.TOPWALL,i,0,this.ghostLayer),this.map.putTile(this.DungeonGenerator.BOTTOMWALL,i,e-1,this.ghostLayer);for(var s=0;e>s;s++)this.map.putTile(this.DungeonGenerator.RIGHTWALL,0,s,this.ghostLayer),this.map.putTile(this.DungeonGenerator.LEFTWALL,t-1,s,this.ghostLayer)},pickRandomSquare:function(){var t=Math.floor(Math.random()*this.squareSize),e=Math.floor(Math.random()*this.squareSize);return{row:t,col:e}},teleport:function(){this.teleportEmitter.x=this.pacman.x,this.teleportEmitter.y=this.pacman.y,this.teleportEmitter.start(!0,250,null,20),this.moveToSquare(this.teleportZone.x,this.teleportZone.y),this.appearEmitter.x=this.pacman.x,this.appearEmitter.y=this.pacman.y-15,this.appearEmitter.start(!0,250,null,20)},createPacman:function(t,e){this.pacman=new i.Pacman(this,t,e),this.game.add.existing(this.pacman)},spawnMonsters:function(t){for(var e=0;e<t.length;e++){var i=this.pickRandomSquare(),s=this.toWorldPosition(i.row,i.col,6,7);console.log("Spawning ...",i),this.createMonster(s.x,s.y,t[e])}},createMonster:function(t,e,s){var a=new i.MonsterAI(this,t,e,s);return a.player=this.pacman,a.layer=this.layer,a.gridsize=this.gridsize,a.map=this.map,this.physics.arcade.enable(a),a.body.setSize(16,16,0,0),a.anchor.set(.5),a.move(Phaser.DOWN),this.monsters.add(a),a},toWorldPosition:function(t,e,i,s){return new Phaser.Point(16*i+8+t*this.size*this.gridsize,16*s+8+e*this.size*this.gridsize)},toGridPosition:function(t,e){var i=new Phaser.Point;return i.x=this.math.snapToFloor(Math.floor(t),this.gridsize)/this.gridsize,i.y=this.math.snapToFloor(Math.floor(e),this.gridsize)/this.gridsize,i},toCellPosition:function(t,e){var i=new Phaser.Point;return i.x=Math.floor(t/this.size),i.y=Math.floor(e/this.size),i},getJumpTargetPosition:function(){var t=this.pacman.getGridPosition(),e=this.toWorldPosition(this.teleportZone.x,this.teleportZone.y,t.x%10,t.y%10),i=this.toGridPosition(e.x,e.y),s=this.map.getTile(i.x,i.y,0);return s.index!==this.safetile&&this.pacman.previousTarget?e=this.pacman.previousTarget:this.pacman.previousTarget=e,e},moveToSquare:function(t,e){var i=this.getJumpTargetPosition();this.pacman.x=i.x,this.pacman.y=i.y,this.teleportZone.x=this.activeZone.x,this.teleportZone.y=this.activeZone.y,this.activeZone.x=t,this.activeZone.y=e,this.isFreshJump=!0,this.pacman.anchor.set(.5),this.pacman.current=Phaser.NONE},checkKeys:function(){this.cursors.left.isDown&&this.pacman.current!==Phaser.LEFT?this.pacman.checkDirection(Phaser.LEFT):this.cursors.right.isDown&&this.pacman.current!==Phaser.RIGHT?this.pacman.checkDirection(Phaser.RIGHT):this.cursors.up.isDown&&this.pacman.current!==Phaser.UP?this.pacman.checkDirection(Phaser.UP):this.cursors.down.isDown&&this.pacman.current!==Phaser.DOWN?this.pacman.checkDirection(Phaser.DOWN):this.pacman.turning=Phaser.NONE},updateTeleportZone:function(t){this.isFreshJump&&(this.teleportZone.x=this.activeZone.x,this.teleportZone.y=this.activeZone.y,this.isFreshJump=!1);var e=new Phaser.Point(this.teleportZone.x,this.teleportZone.y),i=function(t,e){return Phaser.Point.equals(t,this.activeZone)?e:0};t===Phaser.LEFT?(e.x--,e.x+=i.call(this,e,-1)):t===Phaser.RIGHT?(e.x++,e.x+=i.call(this,e,1)):t===Phaser.DOWN?(e.y++,e.y+=i.call(this,e,1)):t===Phaser.UP&&(e.y--,e.y+=i.call(this,e,-1));var s=new Phaser.Point(this.teleportZone.x,this.teleportZone.y);this.teleportZone.copyFrom(e),this.clipTeleportZone(),this.teleportZone.x===this.activeZone.x&&this.teleportZone.y===this.activeZone.y&&(this.teleportZone.x=s.x,this.teleportZone.y=s.y),this.clipTeleportZone()},clipTeleportZone:function(){this.teleportZone.x<0?this.teleportZone.x=0:this.teleportZone.x>this.squareSize-1&&(this.teleportZone.x=this.squareSize-1),this.teleportZone.y<0?this.teleportZone.y=0:this.teleportZone.y>this.squareSize-1&&(this.teleportZone.y=this.squareSize-1)},eatDot:function(t,e){e.kill(),this.score+=10,this.scoreTxt.text=this.score,this.isCellCleared(e)},isCellCleared:function(t){var e=this.toGridPosition(t.x,t.y),i=this.toCellPosition(e.x,e.y);this.cells[i.x][i.y].isCleared()},touchMonsters:function(t,e){console.log("touched the monster",e),this.livesLeft-=1,this.updateLives(),t.onDie()},doShakeScreen:function(){this.shakeWorld=30},shakeScreen:function(){if(this.shakeWorld>0){var t=this.rnd.integerInRange(this.offset.x-5,this.offset.x+5),e=this.rnd.integerInRange(this.offset.y-5,this.offset.y+5);this.game.world.setBounds(t,e,this.game.width+t,this.game.height+e),this.shakeWorld--,0===this.shakeWorld&&this.game.world.setBounds(this.offset.x,this.offset.y,this.game.width,this.game.height)}},drawTeleportPath:function(){this.graphics.clear(),this.graphics.lineStyle(1,16711680,.8);var t=this.getJumpTargetPosition();this.graphics.moveTo(this.pacman.x,this.pacman.y),this.c1.x=this.pacman.x,this.c1.y=this.pacman.y-15,this.c2.x=t.x,this.c2.y=t.y-15,this.pacman.y>t.y?this.c1.y=t.y:this.pacman.y===t.y?(this.c1.y-=30,this.c2.y-=30):this.c2.y=this.pacman.y,this.graphics.bezierCurveTo(this.c1.x,this.c1.y,this.c2.x,this.c2.y,t.x,t.y)},update:function(t){if(this.physics.arcade.collide(this.monsters,this.ghostLayer),this.physics.arcade.collide(this.pacman,this.layer),this.physics.arcade.overlap(this.pacman,this.dots,this.eatDot,null,this),this.physics.arcade.collide(this.pacman,this.monsters,this.touchMonsters,null,this),this.pacman.marker=this.pacman.getGridPosition(),!(this.pacman.marker.x<0||this.pacman.marker.y<0)){var e=this.map.getLayer(this.layer);this.pacman.directions[1]=this.map.getTileLeft(e,this.pacman.marker.x,this.pacman.marker.y),this.pacman.directions[2]=this.map.getTileRight(e,this.pacman.marker.x,this.pacman.marker.y),this.pacman.directions[3]=this.map.getTileAbove(e,this.pacman.marker.x,this.pacman.marker.y),this.pacman.directions[4]=this.map.getTileBelow(e,this.pacman.marker.x,this.pacman.marker.y),this.checkKeys(),this.pacman.turning!==Phaser.NONE&&this.pacman.turn();for(var i=0;i<this.cells.length;i++)for(var s=0;s<this.cells[i].length;s++)this.cells[i][s].update(t.time);this.drawTeleportPath(),this.shakeScreen()}},render:function(){this.monsters.callAll("render"),this.pacman.render()}},window.pacdungeon=window.pacdungeon||{},window.pacdungeon.Game=t}(),window.onload=function(){"use strict";var t,e=window.pacdungeon;t=new Phaser.Game(640,640,Phaser.AUTO,"pacdungeon-game"),t.state.add("boot",e.Boot),t.state.add("preloader",e.Preloader),t.state.add("menu",e.Menu),t.state.add("game",e.Game),t.state.start("boot")},function(){"use strict";function t(){this.titleTxt=null,this.startTxt=null}t.prototype={create:function(){var t=this.game.width/2,e=this.game.height/2;this.titleTxt=this.add.bitmapText(t,e,"minecraftia","Yo, Pacman with a Teleporter!"),this.titleTxt.align="center",this.titleTxt.x=this.game.width/2-this.titleTxt.textWidth/2,e=e+this.titleTxt.height+5,this.startTxt=this.add.bitmapText(t,e,"minecraftia","START"),this.startTxt.align="center",this.startTxt.x=this.game.width/2-this.startTxt.textWidth/2,this.input.onDown.add(this.onDown,this)},update:function(){},onDown:function(){var t=this.game.add.tween(this.titleTxt);t.to({x:-900},300),t.onComplete.addOnce(function(){this.game.state.start("game")},this),t.start()}},window.pacdungeon=window.pacdungeon||{},window.pacdungeon.Menu=t}(),function(){"use strict";function t(){this.asset=null,this.ready=!1}t.prototype={preload:function(){this.asset=this.add.sprite(.5*this.game.width-110,.5*this.game.height-10,"preloader"),this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.load.setPreloadSprite(this.asset),this.loadResources()},loadResources:function(){this.load.bitmapFont("minecraftia","assets/minecraftia.png","assets/minecraftia.xml"),this.load.spritesheet("ghost","assets/ghosts.png",32,32),this.load.spritesheet("ghost-eyes","assets/ghost-eyes.png",32,32),this.load.image("dot","assets/dot.png"),this.load.image("tiles","assets/pacman-tiles.png"),this.load.spritesheet("pacman","assets/pacman.png",32,32),this.load.tilemap("map","assets/pacman-small.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("levels","assets/pacman-maze.json",null,Phaser.Tilemap.TILED_JSON)},create:function(){this.asset.cropEnabled=!1},update:function(){this.ready&&this.game.state.start("menu")},onLoadComplete:function(){this.ready=!0}},window.pacdungeon=window.pacdungeon||{},window.pacdungeon.Preloader=t}();